---
title: イーサネット
type: docs
author: showa
lastmod: 2023-10-09T04:52:46+09:00
waight: 1
---

主に室内や建物内でコンピュータや電子機器をケーブルで繋いで通信する有線LANの標準の一つ。  
ハブやネットワークスイッチを中心として接続を集約するスター型を採用している。  

## [CSMA/CD方式](https://www.infraexpert.com/study/ethernet5.html)

初期のEthernetで用いられた半二重通信でアクセス制御方式。衝突を検出したら、ランダムな時間を待ってからフレームの再送を行う。  

伝送できるパケットサイズの最小：46バイト、最大（MTU）：1500バイト

- CSMA（搬送波感知多重アクセス）：他の機器の通信を監視し、ある機器が送信を行っている最中は別の機器は送信を開始しない。フレームの送信が完了した後、次のフレームを送信を始めるには時間間隔を開ける必要がある。（フレーム感覚時間：IFG）
- CD（衝突検出）：通信状況（電気信号の状況）を確認し、衝突発生を電気的に検出できるメカニズム。

## イーサネットフレーム

![フレーム](https://scrapbox.io/files/60cbf17251f14d0023c3943f.png)

イーサネット上でやりとりされるデータ。[OSI 7階層参照モデル]のデータリンク層に位置する。  

- プリアンブル：フレームが始まることを表す制御用信号。同期信号のため、物理層に位置する。
- アドレス：宛先アドレスと送信元アドレスのビット列。送信元アドレスは、ネットワークインターフェースに割り当てられるMACアドレス。宛先アドレスは、宛先のネットワークインターフェースのMACアドレス。
- タイプ／長さ：1500以下の場合、データ長。1500より大きい場合、データのタイプを表す。
- データ部：「タイプ／長さ」にタイプが指定されている場合、伝送データがなくなったらフレームの末尾まで受信されたことを識別できる。
- LLC部：長さが指定された場合、データ部の先頭に管理情報がおかれる。
- エラーチェック：プリアンブルより後のデータ部までの情報から算術的に導出されたエラーチェック情報（CRC）。

## VLAN

１台ないし複数台のスイッチに接続されている多数の機器をグループに分け、複数のネットワークに分離する機能。

### タグVLAN

イーサネットフレームにVLAN IDを収めたタグを付加する。この情報に基づいてLANを仮想的に分割する方法。  
VLANタグを含むイーサネットフレームの最大長は1522バイト。  

VLANタグの構造

| タグ | バイト| 値 |
|:--|:--|:--|
| TPIP（タグプロトコル識別子） | ２バイト | VLANタグであることを示す0x8100というタイプ情報。 |
| TCI（タグ制御情報） |  |  |
| 優先度 | ３ビット | ０～７ |
| CFI（正規フォーマット識別子） | １ビット | 0 |
| VLAN ID | １２ビット | ０～４０９５ |

### MAC VLAN

スイッチ内部にグループを設定し、MACアドレスを登録することでグループに登録された機器間でのみフレームの中継を行う。  

### ポートVLAN

スイッチのポート単位でグループを分けてネットワークを分離する。  
ポートにID（VLAN ID）を割り当てて、同一のVLAN IDをもつポートのグループ内でのみ中継を行われる。  
